<!DOCTYPE html>
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1,user-scalable=no">
  <title>空美卡</title>
  <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/normalize.css">
  <link rel="stylesheet" href="./assets/css/app.css">
  <link rel="stylesheet" href="./assets/css/libs/dialog.css">
  <script src="//res.wx.qq.com/open/js/jweixin-1.4.0.js"></script>
  <script src="//cdn.jsdelivr.net/jquery/2.2.3/jquery.slim.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/axios@0.19.0/dist/axios.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/promise-polyfill@8.1.3/dist/polyfill.min.js"></script>
  <script src="./assets/js/libs/dialog.min.js"></script>
</head>
<body class="detail-body">
    <noscript>
      <strong>We're sorry but the page doesn't work properly without JavaScript enabled. Please enable it to continue.</strong>
    </noscript>
    <div id="app">
        <div class="container">
            <div class="bg" style="background-color: #a1ceed;"></div>
            <div class="card-mini">
                <img src="./assets/images/card/1_mini.jpg" alt="">
                <h1>清爽空美周周卡</h1>
            </div>
            <div class="share-users">
                <a><img src="http://via.placeholder.com/70" alt=""></a>
                <a><img src="http://via.placeholder.com/70" alt=""></a>
                <a><img src="http://via.placeholder.com/70" alt=""></a>
                <a><img src="http://via.placeholder.com/70" alt=""></a>
                <a><img src="http://via.placeholder.com/70" alt=""></a>
                <em>78 人已邀请好友</em>
            </div>
            <form method="post" class="share-form">
                <h3>定制你的祝福语</h3>
                <ul>
                    <li>
                        <label>
                            <a href="javascript:;" class="voice" style="width: 120px">
                                <i></i>
                                <span>15″</span>
                                <sub></sub>
                                <audio src="https://ia801704.us.archive.org/21/items/idabkar/001.mp3" preload="auto"></audio>
                            </a>
                            我是周周，欢迎登录黑源素空美饮航健康之旅。
                            <input type="radio" name="radio" value="0" checked />
                            <i class="radio"></i>
                        </label>
                    </li>
                    <li>
                        <label>
                            送你一张黑源素60元代金券，空姐带你一起喝起来！送你一张黑源素60元代金券，空姐带你一起喝起来！送你一张黑源素60元代金券，空姐带你一起喝起来！送你一张黑源素60元代金券，空姐带你一起喝起来！送你一张黑源素60元代金券，空姐带你一起喝起来！送你一张黑源素60元代金券，空姐带你一起喝起来！
                            <input type="radio" name="radio" value="1" />
                            <i class="radio"></i>
                        </label>
                    </li>
                    <li>
                        <label>
                            自定义祝福的话
                            <input type="radio" name="radio" value="2" />
                            <i class="radio"></i>
                        </label>
                        <textarea name="textarea" rows="3" class="textarea" placeholder="不超过40个字"></textarea>
                    </li>
                </ul>
                <button type="submit" class="btn btn-block">下一步</button>
            </form>
        </div>
    </div>
    <script src="./assets/js/app.js"></script>
    <script>
        $(function() {
            $('.share-form .textarea').on('focus', function() {
                $(this).siblings('label').find('input:radio').prop('checked', true);
            });
            $('.share-form').on('submit', function(e) {
                axios.post('./mocks/submit.json', $(this).serialize()).then(function(res) {
                    if (res.data.error) {
                        $(document).dialog({
                            content: res.data.msg,
                        });
                    } else {
                        location.href = 'share.html';
                    }
                });
                e.preventDefault();
            });
            var audio = $('.voice audio');
            if (audio.length > 0) {
                audio[0].addEventListener('ended', function () {
                    $(this).closest('.voice').removeClass('play');
                    this.currentTime = 0;
                    this.pause();
                }, false);
                $('.voice').on('click', function(e) {
                    if ($(this).toggleClass('play').hasClass('play')) {
                        audio[0].play();
                    } else {
                        audio[0].currentTime = 0;
                        audio[0].pause();
                    }
                    e.preventDefault();
                });
            }
        })
    </script>
</body>
</html>
